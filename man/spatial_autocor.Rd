% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/spatial_weights.R
\name{spatial_autocor}
\alias{spatial_autocor}
\title{Compute a Spatial Autocorrelation Matrix}
\usage{
spatial_autocor(X, cds, radius = 8, nsamples = 1000)
}
\arguments{
\item{X}{A numeric matrix or data frame where each column represents a variable
and each row represents an observation.}

\item{cds}{A numeric matrix or data frame of spatial coordinates (x, y, or more
dimensions) with the same number of rows as X.}

\item{radius}{A positive numeric value specifying the search radius for the
radius-based nearest neighbor search. Default is 8.}

\item{nsamples}{A positive integer indicating the number of samples for fitting
the GAM. Default is 1000. If the number of rows in cds is less than nsamples,
all points will be used.}
}
\value{
A sparse Matrix object representing the spatial autocorrelation matrix,
  where each element (i,j) represents the predicted correlation between points
  i and j based on their spatial distance.
}
\description{
Computes a spatial autocorrelation matrix using radius-based nearest neighbor search
and Generalized Additive Models (GAM). The function first samples points within
the specified radius, fits a GAM to model the spatial correlation, and then
constructs the autocorrelation matrix.
}
\details{
The function performs the following steps:
1. Conducts radius-based nearest neighbor search using HNSW
2. Samples points and computes correlations within the radius
3. Fits a GAM to model the spatial correlation decay
4. Constructs a sparse matrix representing spatial autocorrelation
}
\examples{
\dontrun{
# Create sample data
n <- 100
coords <- matrix(runif(n*2), n, 2)
X <- matrix(rnorm(n*5), n, 5)

# Compute spatial autocorrelation
autocor_mat <- spatial_autocor(X, coords, radius=5, nsamples=500)
}

}
