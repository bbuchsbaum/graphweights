% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/local_global_knn.R
\name{local_global_adjacency}
\alias{local_global_adjacency}
\title{Local + Global KNN Adjacency}
\usage{
local_global_adjacency(
  coord_mat,
  L = 5,
  K = 5,
  r,
  weight_mode = c("heat", "binary"),
  sigma = r/2,
  far_penalty = c("lambda", "exp"),
  lambda = 0.6,
  tau = r,
  nnk_buffer = 10,
  include_diagonal = FALSE,
  symmetric = TRUE,
  normalized = FALSE
)
}
\arguments{
\item{coord_mat}{Numeric matrix of coordinates (rows = points).}

\item{L}{Number of local neighbors (within \code{r}) to keep for each point.}

\item{K}{Number of far neighbors (outside \code{r}) to keep for each point.}

\item{r}{Radius defining the local ball.}

\item{weight_mode}{Weighting scheme name (e.g., "heat"); forwarded to internal helper get_neighbor_fun.}

\item{sigma}{Bandwidth for the heat/normalized kernels; default \code{r/2}.}

\item{far_penalty}{Either \code{"lambda"} (constant multiplier) or
\code{"exp"} (decay with distance beyond \code{r}).}

\item{lambda}{Constant multiplier for far neighbors when
\code{far_penalty = "lambda"}.}

\item{tau}{Scale of exponential decay when \code{far_penalty = "exp"}.}

\item{nnk_buffer}{Extra candidates requested from the NN search to ensure
enough far neighbors are available.}

\item{include_diagonal}{Logical; keep self-loops.}

\item{symmetric}{Logical; if TRUE, symmetrize by averaging \code{A} and
\code{t(A)}.}

\item{normalized}{Logical; if TRUE, row-normalize the matrix (stochastic).}
}
\value{
A sparse adjacency matrix mixing local and far neighbors.
}
\description{
Build an adjacency matrix that mixes \code{L} neighbors inside a local radius
\code{r} with \code{K} neighbors outside that radius. Far neighbors receive a
mild penalty so they can contribute without dominating.
}
\examples{
set.seed(1)
coords <- matrix(runif(200), ncol = 2)
A <- local_global_adjacency(coords, L = 4, K = 3, r = 0.15,
                            weight_mode = "heat", lambda = 0.7)
Matrix::rowSums(A)[1:5]
}
