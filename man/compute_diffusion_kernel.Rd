% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/diffusion.R
\name{compute_diffusion_kernel}
\alias{compute_diffusion_kernel}
\title{Compute Markov diffusion kernel via eigen decomposition}
\usage{
compute_diffusion_kernel(A, t, k = NULL, symmetric = TRUE)
}
\arguments{
\item{A}{Square sparse adjacency matrix (dgCMatrix) of an undirected, weighted graph with non-negative entries.}

\item{t}{Diffusion time parameter (positive scalar).}

\item{k}{Number of leading eigenpairs to compute. If NULL, performs full eigendecomposition.}

\item{symmetric}{If TRUE (default), uses symmetric normalization to guarantee real eigenvalues.}
}
\value{
dgCMatrix representing the diffusion kernel matrix.
}
\description{
Efficient computation of the Markov diffusion kernel for a graph represented by
a sparse adjacency matrix. For large graphs, uses RSpectra to compute only the
leading k eigenpairs of the normalized transition matrix.
}
\examples{
library(Matrix)
# Create a simple 3x3 adjacency matrix
A <- sparseMatrix(i = c(1, 1, 2, 2, 3, 3), 
                  j = c(2, 3, 1, 3, 1, 2), 
                  x = c(1, 1, 1, 1, 1, 1), dims = c(3, 3))

# Compute diffusion kernel with t = 0.5
K <- compute_diffusion_kernel(A, t = 0.5)
print(K)

# Use only top 2 eigenpairs for efficiency
K_approx <- compute_diffusion_kernel(A, t = 0.5, k = 2)
}
